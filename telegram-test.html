<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmokyApp - Telegram WebApp Test</title>
    
    <!-- Telegram WebApp Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/components.css">
    
    <!-- Preload –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        .telegram-info {
            position: fixed;
            top: 10px;
            left: 10px;
            right: 10px;
            background: var(--color-info);
            color: var(--color-text-inverse);
            padding: var(--spacing-3);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            z-index: 10002;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .telegram-info h4 {
            margin: 0 0 var(--spacing-2) 0;
            font-size: var(--font-size-base);
        }
        
        .telegram-info-item {
            margin-bottom: var(--spacing-1);
            font-family: monospace;
        }
        
        .app {
            padding-top: 220px; /* –ú–µ—Å—Ç–æ –¥–ª—è –∏–Ω—Ñ–æ –ø–∞–Ω–µ–ª–∏ */
        }
    </style>
</head>
<body>
    <!-- Telegram Info Panel -->
    <div class="telegram-info" id="telegram-info">
        <h4>üîç Telegram WebApp Info</h4>
        <div id="telegram-details">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <div id="app" class="app">
        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
        <div id="progress-bar" class="progress-bar">
            <div class="progress-bar__fill" id="progress-fill"></div>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ -->
        <main id="screen-container" class="screen-container">
            <!-- –≠–∫—Ä–∞–Ω—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </main>
        
        <!-- Overlay –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="loading-spinner"></div>
            <p class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
        
        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div id="notification-container" class="notification-container"></div>
    </div>

    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ Telegram WebApp
        const showTelegramInfo = () => {
            const detailsContainer = document.getElementById('telegram-details');
            if (!detailsContainer) return;
            
            const webApp = window.Telegram?.WebApp;
            const info = [];
            
            info.push(`<div class="telegram-info-item"><strong>WebApp API:</strong> ${webApp ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}</div>`);
            
            if (webApp) {
                info.push(`<div class="telegram-info-item"><strong>Version:</strong> ${webApp.version || 'Unknown'}</div>`);
                info.push(`<div class="telegram-info-item"><strong>Platform:</strong> ${webApp.platform || 'Unknown'}</div>`);
                info.push(`<div class="telegram-info-item"><strong>Color Scheme:</strong> ${webApp.colorScheme || 'Unknown'}</div>`);
                info.push(`<div class="telegram-info-item"><strong>Init Data:</strong> ${webApp.initData ? '–ï—Å—Ç—å (' + webApp.initData.length + ' —Å–∏–º–≤–æ–ª–æ–≤)' : '–ù–µ—Ç'}</div>`);
                info.push(`<div class="telegram-info-item"><strong>User ID:</strong> ${webApp.initDataUnsafe?.user?.id || '–ù–µ—Ç'}</div>`);
                info.push(`<div class="telegram-info-item"><strong>User Name:</strong> ${webApp.initDataUnsafe?.user?.first_name || '–ù–µ—Ç'}</div>`);
                info.push(`<div class="telegram-info-item"><strong>Viewport:</strong> ${webApp.viewportWidth}x${webApp.viewportHeight}</div>`);
                info.push(`<div class="telegram-info-item"><strong>Is Expanded:</strong> ${webApp.isExpanded ? '–î–∞' : '–ù–µ—Ç'}</div>`);
            }
            
            info.push(`<div class="telegram-info-item"><strong>User Agent:</strong> ${navigator.userAgent}</div>`);
            info.push(`<div class="telegram-info-item"><strong>URL:</strong> ${window.location.href}</div>`);
            info.push(`<div class="telegram-info-item"><strong>Parent Window:</strong> ${window.parent !== window ? '–í iframe' : '–û–±—ã—á–Ω–æ–µ –æ–∫–Ω–æ'}</div>`);
            info.push(`<div class="telegram-info-item"><strong>TelegramWebviewProxy:</strong> ${window.TelegramWebviewProxy ? '–ï—Å—Ç—å' : '–ù–µ—Ç'}</div>`);
            
            detailsContainer.innerHTML = info.join('');
        };
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        setInterval(showTelegramInfo, 3000);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ä–∞–∑—É
        setTimeout(showTelegramInfo, 500);
        
        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        console.log('üîç Telegram Test Page –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        console.log('üîç Telegram WebApp:', window.Telegram?.WebApp);
        
        // –ï—Å–ª–∏ Telegram WebApp –¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –µ–≥–æ
        if (window.Telegram?.WebApp) {
            const webApp = window.Telegram.WebApp;
            
            // –ì–æ–≤–æ—Ä–∏–º Telegram —á—Ç–æ –º—ã –≥–æ—Ç–æ–≤—ã
            webApp.ready();
            
            // –†–∞—Å—à–∏—Ä—è–µ–º –æ–∫–Ω–æ
            webApp.expand();
            
            console.log('üîç Telegram WebApp –Ω–∞—Å—Ç—Ä–æ–µ–Ω');
        }
    </script>

    <!-- Core Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/api.js"></script>
    <script src="js/telegram.js"></script>
    <script src="js/router.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
